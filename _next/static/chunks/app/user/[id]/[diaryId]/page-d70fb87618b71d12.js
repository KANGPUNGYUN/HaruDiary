(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{2247:function(a,t,e){Promise.resolve().then(e.bind(e,2588)),Promise.resolve().then(e.bind(e,9522))},2588:function(a,t,e){"use strict";e.r(t),e.d(t,{default:function(){return i}});var c=e(7437),l=e(4033),s=e(2759),o=e(504);function i(){let a=(0,l.useRouter)();return(0,c.jsxs)("div",{className:"p-back-button",onClick:()=>a.back(),children:[(0,c.jsx)(o.G,{icon:s.A35,width:"16",height:"16"})," 이전 페이지"]})}},9522:function(a,t,e){"use strict";e.r(t),e.d(t,{default:function(){return m}});var c=e(7437),l=e(2265),s=e(9222),o=e(4033),i=e(2749),n=e(1865),r=e(1396),d=e.n(r),u=e(2759),h=e(504);function m(){var a,t,e,r,m,p;let[x,v]=(0,l.useState)(null),[j,y]=(0,l.useState)(!1),[N,f]=(0,l.useState)(!1),[g,b]=(0,l.useState)(!1),[k,_]=(0,l.useState)(0),w=(0,o.useParams)(),{data:I,status:C}=(0,i.useSession)(),S=(0,o.useSearchParams)(),Z=null==S?void 0:S.get("modal"),G=null==S?void 0:S.get("reportModal"),F=(0,o.useRouter)(),{register:B,handleSubmit:E,formState:{errors:R}}=(0,n.cI)();async function A(){try{let a=await s.Z.post("".concat("http://localhost:3000","/api/user/").concat(w.id,"/").concat(w.diaryId,"/deleteDiary"),{id:w.diaryId});200===a.status&&y(!0)}catch(a){console.log(a)}}async function D(){try{let a=await s.Z.post("".concat("http://localhost:3000","/api/user/").concat(w.id,"/").concat(w.diaryId,"/like"),{id:k});if(200===a.status){f(!0);let a=async()=>{try{let a=await s.Z.get("".concat("http://localhost:3000","/api/user/").concat(w.id,"/").concat(w.diaryId)),t=await a.data;return t}catch(a){console.log(a)}};a().then(a=>{v(a)})}}catch(a){console.log(a)}}async function L(){try{let a=await s.Z.post("".concat("http://localhost:3000","/api/user/").concat(w.id,"/").concat(w.diaryId,"/unlike"),{id:k});if(200===a.status){f(!1);let a=async()=>{try{var a;let t=await s.Z.get("".concat("http://localhost:3000","/api/user/").concat(w.id,"/").concat(w.diaryId),{headers:{authorization:null==I?void 0:null===(a=I.user)||void 0===a?void 0:a.accessToken}}),e=await t.data;return e}catch(a){console.log(a)}};a().then(a=>{v(a)})}}catch(a){console.log(a)}}async function P(a){try{let t=await s.Z.post("".concat("http://localhost:3000","/api/user/").concat(w.id,"/").concat(w.diaryId,"/report"),{id:k,reportBy:a.reportBy});console.log(t),200===t.status&&b(!0)}catch(a){console.log(a)}}return(0,l.useEffect)(()=>{if(x){let a=async()=>{try{let a=await s.Z.post("".concat("http://localhost:3000","/api/user/").concat(w.id,"/").concat(w.diaryId,"/views"),{views:x._count}),t=await a.data;return t}catch(a){console.log(a)}};a()}},[]),(0,l.useEffect)(()=>{if("authenticated"===C&&I&&I.user){let a=async()=>{try{let a=await s.Z.post("".concat("http://localhost:3000","/api/signin/userCheck"),{email:null==I?void 0:I.user.email,auth:null==I?void 0:I.user.provider});_(a.data)}catch(a){console.log(a)}},t=async()=>{try{if(0!==k){let a=await s.Z.post("".concat("http://localhost:3000","/api/user/").concat(w.id,"/").concat(w.diaryId,"/checkIsLiked"),{userId:k});0!==a.data&&f(!0)}}catch(a){console.log(a)}},e=async()=>{try{let a=await s.Z.get("".concat("http://localhost:3000","/api/user/").concat(w.id,"/").concat(w.diaryId)),t=await a.data;return t}catch(a){console.log(a)}};a().then(()=>{t()}),e().then(a=>{v(a)})}else{let a=async()=>{try{let a=await s.Z.get("".concat("http://localhost:3000","/api/user/").concat(w.id,"/").concat(w.diaryId)),t=await a.data;return t}catch(a){console.log(a)}};a().then(a=>{v(a)})}},[C,k]),(0,c.jsxs)(c.Fragment,{children:[x&&(null==x?void 0:null===(a=x._count)||void 0===a?void 0:a.report)>0?(0,c.jsxs)("div",{className:"p-diary-paper",children:[(0,c.jsx)("div",{className:"p-diary-report-main",children:(0,c.jsxs)("div",{children:[(0,c.jsx)(h.G,{icon:u.WV2,className:"modal-icon-exclamation"}),(0,c.jsx)("p",{children:"해당 일기는 신고가 접수되어 검토 중인 일기입니다."})]})}),(0,c.jsxs)("div",{className:"p-diary-footer",children:[(0,c.jsxs)("div",{children:["조회수 ",null==x?void 0:x.views]}),(0,c.jsxs)("div",{children:["참 잘했어요 ",null==x?void 0:null===(t=x._count)||void 0===t?void 0:t.likes]})]})]}):(0,c.jsxs)("div",{className:"p-diary-paper",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("p",{className:"p-diary-date",children:"".concat(x&&new Date(null==x?void 0:x.createdAt).toLocaleString("ko-KR").split(".")[0],"년 ").concat(x&&new Date(null==x?void 0:x.createdAt).toLocaleString("ko-KR").split(".")[1],"월 ").concat(x&&new Date(null==x?void 0:x.createdAt).toLocaleString("ko-KR").split(".")[2],"일")}),(0,c.jsx)("div",{className:"p-diary-title",children:null==x?void 0:x.title}),(0,c.jsx)("div",{className:"p-diary-content",children:(0,c.jsx)("pre",{style:{whiteSpace:"pre-wrap"},children:null==x?void 0:x.content})})]}),(0,c.jsxs)("div",{className:"p-diary-footer",children:[(0,c.jsxs)("div",{children:["조회수 ",null==x?void 0:x.views]}),(0,c.jsxs)("div",{children:["참 잘했어요 ",null==x?void 0:null===(e=x._count)||void 0===e?void 0:e.likes]})]})]}),(0,c.jsx)("div",{className:"p-diary-utility",children:(null==x?void 0:x.authorId)===(null==I?void 0:I.user.id)||(null==x?void 0:null===(r=x.author)||void 0===r?void 0:r.auth)===(null==I?void 0:I.user.provider)&&(null==x?void 0:null===(m=x.author)||void 0===m?void 0:m.email)===(null==I?void 0:I.user.email)?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(d(),{href:"/user/".concat(w.id,"/").concat(w.diaryId,"/update"),className:"p-diary-like-button",children:"수정하기"}),(0,c.jsx)(d(),{href:"/user/".concat(w.id,"/").concat(w.diaryId,"/?modal=true"),className:"p-diary-report-button",children:"삭제하기"}),Z&&(0,c.jsx)("div",{className:"modal__outer",children:(0,c.jsx)("div",{className:"modal",style:{height:"240px"},children:j?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(d(),{href:"/user/".concat(w.id),className:"modal-escape",children:(0,c.jsx)(h.G,{icon:u.g82})}),(0,c.jsx)("div",{className:"modal-title__outer",children:(0,c.jsx)("h1",{className:"modal-title",children:"정상적으로 삭제되었습니다."})}),(0,c.jsx)("div",{className:"modal-button__outer",children:(0,c.jsx)(d(),{href:"/user/".concat(w.id),className:"modal-button confirm",children:"확인"})})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("button",{className:"modal-escape",onClick:F.back,children:(0,c.jsx)(h.G,{icon:u.g82})}),(0,c.jsxs)("div",{className:"modal-title__outer",children:[(0,c.jsx)(h.G,{icon:u.WV2,className:"modal-icon-exclamation"}),(0,c.jsx)("h1",{className:"modal-title",children:"일기를 정말 삭제하시겠습니까?"})]}),(0,c.jsxs)("div",{className:"modal-button__outer",children:[(0,c.jsx)("button",{className:"modal-button cancel",onClick:F.back,children:"취소"}),(0,c.jsx)("button",{className:"modal-button confirm",onClick:()=>{A()},children:"확인"})]})]})})})]}):I&&I.user?(0,c.jsxs)(c.Fragment,{children:[N?(0,c.jsx)("button",{className:"p-diary-like-button cancel",onClick:()=>{L()},children:"참 잘했어요 취소"}):(0,c.jsx)("button",{className:"p-diary-like-button",onClick:()=>{D()},children:"참 잘했어요"}),(0,c.jsx)(d(),{href:"/user/".concat(w.id,"/").concat(w.diaryId,"/?reportModal=true"),className:"p-diary-report-button",children:"신고하기"}),G&&(0,c.jsx)("div",{className:"modal__outer",children:(0,c.jsx)("div",{className:"modal",style:g?{height:"200px"}:{height:"400px"},children:g?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(d(),{href:"/user/".concat(w.id),className:"modal-escape",children:(0,c.jsx)(h.G,{icon:u.g82})}),(0,c.jsx)("div",{className:"modal-title__outer",children:(0,c.jsx)("h1",{className:"modal-title",children:"정상적으로 신고되었습니다."})}),(0,c.jsx)("div",{className:"modal-button__outer",children:(0,c.jsx)(d(),{href:"/user/".concat(w.id),className:"modal-button confirm",children:"확인"})})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("button",{className:"modal-escape",onClick:F.back,children:(0,c.jsx)(h.G,{icon:u.g82})}),(0,c.jsxs)("div",{className:"modal-title__outer",children:[(0,c.jsx)(h.G,{icon:u.WV2,className:"modal-icon-exclamation"}),(0,c.jsx)("h1",{className:"modal-title",children:"해당 일기를 정말 신고하시겠습니까?"}),(0,c.jsx)("span",{className:"modal-content",children:"신고 즉시 해당 일기는 비공개 처리되며, 관리자가 최종 검토하여 신고자 이메일로 결과를 전달합니다."})]}),(0,c.jsxs)("form",{className:"modal-form",children:[(0,c.jsxs)("span",{children:["- 구체적인 신고 사유"," ",(0,c.jsx)("span",{className:"modal-form-require",children:"필수"})]}),(0,c.jsx)("textarea",{...B("reportBy",{required:"신고 사유를 입력해주세요."}),className:R.reportBy?"modal-textarea errored":"modal-textarea",placeholder:"예시) 음담패설/욕설/명예훼손 등 비난성 글, 광고성 목적의 글, 특정 종교/정치/이념 등의 소재로 분쟁을 야기하는 글"}),(0,c.jsx)("div",{className:"modal-form-error-message",children:null===(p=R.reportBy)||void 0===p?void 0:p.message})]}),(0,c.jsxs)("div",{className:"modal-button__outer",children:[(0,c.jsx)("button",{className:"modal-button cancel",onClick:F.back,children:"취소"}),(0,c.jsx)("button",{className:"modal-button confirm",onClick:E(a=>{P(a)}),children:"신고"})]})]})})})]}):""})]})}},1396:function(a,t,e){a.exports=e(6685)}},function(a){a.O(0,[676,685,35,222,232,865,971,596,744],function(){return a(a.s=2247)}),_N_E=a.O()}]);